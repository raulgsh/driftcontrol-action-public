name: 'DriftControl'
description: 'Detects and analyzes API and database drift in pull requests'
author: 'driftcontrol'
branding:
  icon: 'git-branch'
  color: 'blue'

inputs:
  token:
    description: 'GitHub token for API access (defaults to GITHUB_TOKEN)'
    required: false
    default: ${{ github.token }}
  openapi_path:
    description: 'Path to the OpenAPI spec file'
    required: false
    default: 'openapi.yaml'
  sql_glob:
    description: 'Glob pattern for SQL migration files'
    required: false
    default: 'migrations/**/*.sql'
  fail_on_medium:
    description: 'Boolean to fail the check on medium-severity drift'
    required: false
    default: 'false'
  override:
    description: 'Boolean to bypass the merge block'
    required: false
    default: 'false'
  terraform_plan_path:
    description: 'Path to Terraform plan JSON file'
    required: false
    default: ''
  cloudformation_glob:
    description: 'Glob pattern for CloudFormation template files'
    required: false
    default: ''
  cost_threshold:
    description: 'Cost increase threshold in USD to trigger medium severity'
    required: false
    default: '1000'
  config_yaml_glob:
    description: 'Glob pattern for configuration YAML files'
    required: false
    default: ''
  feature_flags_path:
    description: 'Path to feature flags configuration file'
    required: false
    default: ''
  llm_provider:
    description: 'LLM provider for enhanced explanations (openai or anthropic)'
    required: false
    default: ''
  llm_api_key:
    description: 'API key for LLM provider (use GitHub secrets)'
    required: false
    default: ''
  llm_model:
    description: 'Model to use (gpt-4, gpt-3.5-turbo, claude-3-opus, claude-3-sonnet)'
    required: false
    default: ''
  llm_max_tokens:
    description: 'Maximum tokens for LLM response'
    required: false
    default: '150'

runs:
  using: 'node20'
  main: 'dist/index.js'